<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Tracking Bug Status</title>
    <meta charset="UTF-8">
    <meta name=description content="">
    <meta name=viewport content="width=device-width, initial-scale=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap CSS -->
    <link href="./css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link href="./css/rickshaw.min.css" rel="stylesheet" media="screen">
    <link href="./css/style.css" rel="stylesheet" media="screen">
  </head>
  <body>
    <div class="container">
      <form id="query-form" name="query-form" action="" method="POST" role="form">
        <legend>Bugzilla Query</legend>

        <div class="form-group">
          <label for="input-id">Tracking Bug</label>
          <input type="text" name="" id="input" class="form-control" value="980408">
        </div>
        <button type="submit" class="btn btn-primary">Submit</button>
      </form>
    </div>

    <div class="container" id="rickshaw-graph"></div>

    <div class="container result-container">
      <label for="output">Results</label><br>
      <pre id="output"></pre>
    </div>
    <script src="./js/jquery.js"></script>
    <script src="./js/bootstrap.min.js"></script>
    <script type="text/javascript" src="./js/bz.js"></script>
    <script type="text/javascript" src="http://underscorejs.org/underscore-min.js"></script>
    <script src="./js/async.js"></script>
    <script src="./js/rickshaw.min.js"></script>
    <script src="./js/bz-console.js"></script>
    <script>
    var ws;
    function socket() {
      ws = new WebSocket("ws://127.0.0.1:9090");
      ws.onmessage = function ( e ) {
        var data = JSON.parse(e.data);
        if (data.r) {
          location.reload();
        }
      };
    }
    setInterval(function () {
      if ( ws ) {
        if ( ws.readyState !== 1 ) {
          socket();
        }
      } else {
        socket();
      }
    }, 1000);
    </script>
  </body>
</html>
